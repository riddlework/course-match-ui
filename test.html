<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>course-match-ui</title>
    <link rel="stylesheet" href="test.css">
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>
    <script src="test.js"></script>
</head>

<body>

    <h2>Course List</h2>

    <!-- Button to add another constraint -->
    <!-- Drag classes into constraints -->
    <!-- Preserve the sorting so don't delete classes after drag from class list -->
    <!-- But delete if dragging out of constraint box -->
  
    <input type="text" id="filter">
  
    <div id="list">
      <ul>
        <li>
          <input type="checkbox"> 
          Item 1
        </li>
        <li>
          <input type="checkbox">
          Item 2  
        </li>
        <li>
          <input type="checkbox">
          Item 3
        </li>
      </ul>
    </div>

    <div id="checked"></div>
  
    <div id="no-results" class="hide">
      No results found
    </div>

    <div class="px2 sm-px3 py2 mb3 col-12 mx-auto">

        <section class="mb3 mx-auto col col-12">
            
            <div class="p3 clearfix bg-silver black">

            <div class="col col-12 mb1">
            <h2 class="h3 m0">Class Constraints</h2>
            </div>

            <div class="col col-6">
                <h2 class="h4 mt1">Class list:</h2>
                <ul class="ml4 js-sortable-copy sortable list flex flex-column list-reset">
                    <li hidden="hidden" class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 1</li>
                    <li class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 2</li>
                    <li class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 3</li>
                    <li class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 4</li>
                    <li class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 5</li>
                    <li class="p1 mb1 silver bg-black" style="position: relative; z-index: 10">Class 6</li>
                </ul>
            </div>

            <div class="col col-6">

                <h2 class="h4 mt1">At most one of:</h2>
                <ul class="p2 border black border-black js-sortable-copy-target1 sortable list flex flex-column list-reset">
                </ul>

            </div>

            <!-- <div class="col col-6">

                <h2 class="h4 mt1">At most two of:</h2>
                <ul class="p2 border black border-black js-sortable-copy-target2 sortable list flex flex-column list-reset">
                </ul>

            </div>
            
            <div class="col col-6">

                <h2 class="h4 mt1">At most three of:</h2>
                <ul class="p2 border black border-black js-sortable-copy-target3 sortable list flex flex-column list-reset">
                </ul>

            </div> -->

        </div>
        </section>

    </div>


    <script>
        const filter = document.getElementById('filter');
        const list = document.getElementById('list');
        const checked = document.getElementById('checked');
        const noResults = document.getElementById('no-results');

        const checkboxes = list.querySelectorAll('input[type="checkbox"]');

        checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', toggleChecked);
        });

        filter.addEventListener('keyup', filterList);

        function toggleChecked(e) {
        const li = e.target.parentElement;
        li.classList.toggle('checked');
        
        if (li.classList.contains('checked')) {
            checked.appendChild(li);
        } else {
            list.appendChild(li); 
        }
        }

        function filterList() {
        const value = filter.value.toLowerCase();
        const items = list.querySelectorAll('li');

        items.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.indexOf(value) === -1) {
            item.classList.add('hide');
            } else {
            item.classList.remove('hide');
            }
        });

        if (items.length === 0) {
            noResults.classList.remove('hide');  
        } else {
            noResults.classList.add('hide');
        }
        }


        sortable('.js-sortable-copy', {
            forcePlaceholderSize: true,
            copy: true,
                acceptFrom: false,
            placeholderClass: 'mb1 bg-navy border border-yellow',
        });
        sortable('.js-sortable-copy-target1', {
            forcePlaceholderSize: true,
            acceptFrom: '.js-sortable-copy, .js-sortable-copy-target1, .js-sortable-copy-target2, .js-sortable-copy-target3',
            placeholderClass: 'mb1 border border-maroon',
            maxItems: 4
            });
        sortable('.js-sortable-copy-target2', {
            forcePlaceholderSize: true,
            acceptFrom: '.js-sortable-copy, .js-sortable-copy-target1, .js-sortable-copy-target2, .js-sortable-copy-target3',
            placeholderClass: 'mb1 border border-maroon',
            maxItems: 4
            });
        sortable('.js-sortable-copy-target3', {
            forcePlaceholderSize: true,
            acceptFrom: '.js-sortable-copy, .js-sortable-copy-target1, .js-sortable-copy-target2, .js-sortable-copy-target3',
            placeholderClass: 'mb1 border border-maroon',
            maxItems: 4
            });
        


        sortable('.js-sortable-buttons', {
            forcePlaceholderSize: true,
            items: 'li',
            placeholderClass: 'border border-white mb1',
        hoverClass: 'bg-yellow'
        });

        // buttons to add items and reload the list
        // separately to showcase issue without reload
        document.querySelector('.js-add-item-button').addEventListener('click', function(){
            doc = new DOMParser().parseFromString(`<li class="p1 mb1 blue bg-white">new item</li>`, "text/html").body.firstChild;
            document.querySelector('.js-sortable-buttons').appendChild(doc);
        });

        document.querySelector('.js-reload').addEventListener('click', function(){
            console.log('Options before re-init:');
            console.log(document.querySelector('.js-sortable-buttons').h5s.data.opts);
            sortable('.js-sortable-buttons');
            console.log('Options after re-init:');
            console.log(document.querySelector('.js-sortable-buttons').h5s.data.opts);
        });

        // JS DISABLED
        document.querySelector('.js-disable').addEventListener('click', function(){
            var $list = document.querySelector('[data-disabled]');
            if ( $list.getAttribute('data-disabled') === 'false' ) {
                this.innerHTML = 'Enable';
                sortable($list, 'disable');
                $list.setAttribute('data-disabled', true);
                $list.classList.add('muted');
            } else {
                this.innerHTML = 'Disable';
                sortable($list, 'enable');
                $list.setAttribute('data-disabled', false);
                $list.classList.remove('muted');
            }
        });

        // Destroy & Init
        document.querySelector('.js-destroy').addEventListener('click', function(){
            sortable('.js-sortable-buttons', 'destroy');
        });
        document.querySelector('.js-init').addEventListener('click', function(){
            sortable('.js-sortable-buttons', {
                forcePlaceholderSize: true,
                items: 'li',
                placeholderClass: 'border border-white mb1'
            });
        });
    </script>
</body>

</html>